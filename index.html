
<!DOCTYPE html>
<html lang="no">
<head>
  <meta charset="UTF-8" />
  <title>MinPris ‚Äì tilbudskalkulator</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
      background: #f5f7fa;
      padding: 20px;
    }

    .container {
      max-width: 700px;
      margin: auto;
      background: white;
      padding: 24px;
      border-radius: 12px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.08);
    }

    h1 {
      margin-bottom: 4px;
    }

    label {
      display: block;
      margin-top: 16px;
      font-weight: 600;
    }

    input, textarea {
      width: 100%;
      padding: 12px;
      margin-top: 6px;
      border-radius: 8px;
      border: 1px solid #ccc;
      font-size: 16px;
    }

    button {
      margin-top: 18px;
      padding: 14px;
      width: 100%;
      font-size: 16px;
      border-radius: 10px;
      border: none;
      cursor: pointer;
      background: #2563eb;
      color: white;
      font-weight: 600;
    }

    .row {
      display: flex;
      gap: 16px;
      align-items: center;
      margin-top: 12px;
    }

    .row input[type="checkbox"] {
      width: auto;
      margin-right: 6px;
    }

    .info {
      margin-top: 10px;
      font-weight: 600;
    }
  </style>
</head>

<body>
  <div class="container">
    <h1>üè† MinPris ‚Äì tilbudskalkulator</h1>
    <p>Kalkuler kj√∏ring automatisk med Google Maps</p>

    <label>Jobbbeskrivelse</label>
    <textarea placeholder="F.eks: 40t riving, 20t rengj√∏ring"></textarea>

    <label>Timepris (kr)</label>
    <input type="number" />

    <label>Firmaadresse</label>
    <input id="fromAddress" placeholder="F.eks: Storgata 1, Oslo" />

    <label>Kundeadresse</label>
    <input id="toAddress" placeholder="F.eks: Karl Johans gate 10, Oslo" />

    <button onclick="calculateDistance()">Beregn avstand automatisk</button>

    <div class="row">
      <input type="checkbox" id="roundTrip" checked />
      <label for="roundTrip">Tur / retur</label>
    </div>

    <label>Kilometer per dag</label>
    <input id="kmPerDag" type="number" />

    <label>Pris per km (kr)</label>
    <input value="15" type="number" />

    <div class="info" id="distanceInfo"></div>
  </div>

  <!-- Google Maps -->
  <script>
    let autocompleteFrom;
    let autocompleteTo;

    function initAutocomplete() {
      autocompleteFrom = new google.maps.places.Autocomplete(
        document.getElementById("fromAddress"),
        { types: ["geocode"], componentRestrictions: { country: "no" } }
      );

      autocompleteTo = new google.maps.places.Autocomplete(
        document.getElementById("toAddress"),
        { types: ["geocode"], componentRestrictions: { country: "no" } }
      );
    }

    async function calculateDistance() {
      const origin = document.getElementById("fromAddress").value;
      const destination = document.getElementById("toAddress").value;
      const roundTrip = document.getElementById("roundTrip").checked;

      if (!origin || !destination) {
        alert("Fyll inn begge adresser");
        return;
      }

      const response = await fetch(
        https://routes.googleapis.com/directions/v2:computeRoutes,
        {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            "X-Goog-Api-Key": "DIN_GOOGLE_MAPS_API_KEY",
            "X-Goog-FieldMask": "routes.distanceMeters"
          },
          body: JSON.stringify({
            origin: { address: origin },
            destination: { address: destination },
            travelMode: "DRIVE"
          })
        }
      );

      const data = await response.json();

      if (!data.routes || !data.routes[0]) {
        alert("Kunne ikke beregne avstand");
        return;
      }

      let meters = data.routes[0].distanceMeters;
      let km = meters / 1000;

      if (roundTrip) km *= 2;

      km = Math.round(km * 10) / 10;

      document.getElementById("kmPerDag").value = km;
      document.getElementById("distanceInfo").innerText =
        Avstand beregnet: ${km} km ${roundTrip ? "(tur/retur)" : "(√©n vei)"};
    }
  </script>

  <script
    src="https://maps.googleapis.com/maps/api/js?key=DIN_GOOGLE_MAPS_API_KEY&libraries=places&callback=initAutocomplete"
    async
    defer
  ></script>
</body>
</html>
